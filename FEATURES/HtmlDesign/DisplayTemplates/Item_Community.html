<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"> 
<head>
<title>$Resources:Microsoft.Office.Server.Search,DisplayTemplateTitle_CommunityItem</title>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:TemplateHidden msdt:dt="string">0</mso:TemplateHidden>
<mso:MasterPageDescription msdt:dt="string"></mso:MasterPageDescription>
<mso:ContentTypeId msdt:dt="string">0x0101002039C03B61C64EC4A04F5361F385106603</mso:ContentTypeId>
<mso:TargetControlType msdt:dt="string">;#SearchResults;#</mso:TargetControlType>
<mso:HtmlDesignAssociated msdt:dt="string">1</mso:HtmlDesignAssociated>
<mso:ManagedPropertyMapping msdt:dt="string">'Title':'Title','Path':'Path','SiteLogo':'SiteLogo','SiteDescription':'SiteDescription','CollapsingStatus':'CollapsingStatus','DocId':'DocId','HitHighlightedProperties':'HitHighlightedProperties','FileExtension':'FileExtension','ViewsLifeTime':'ViewsLifeTime','deeplinks':'deeplinks','importance':'importance','FileType':'FileType','CommunityMembersCount':'CommunityMembersCount','CommunityRepliesCount':'CommunityRepliesCount','CommunityTopicsCount':'CommunityTopicsCount'</mso:ManagedPropertyMapping>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>
<body>
    <div id="Item_Community">
<!--#_
        if(!$isNull(ctx.CurrentItem) && !$isNull(ctx.ClientControl))
        {
            var maxBodyLengthInChars = 120;
            var maxMetadataValue = Srch.U.maximumSocialMetadataValue;

            var id = ctx.ClientControl.get_nextUniqueId();
            var itemId = id + Srch.U.Ids.item;
            var hoverId = id + Srch.U.Ids.hover;
            var hoverUrl = "~sitecollection/_catalogs/masterpage/Display Templates/Search/Item_Community_HoverPanel.js";
            $setResultItem(itemId, ctx.CurrentItem);

            var displayPath = Srch.U.getHighlightedProperty(id, ctx.CurrentItem, "Path");
            var title = Srch.U.getHighlightedProperty(id, ctx.CurrentItem, "Title");
            if ($isEmptyString(title))
            {
                title = $htmlEncode(ctx.CurrentItem.Title)
            }

            var showHoverPanelCallback = Srch.U.getShowHoverPanelCallbackWide(itemId, hoverId, hoverUrl);
            var hideHoverPanelCallback = Srch.U.getHideHoverPanelCallback();

            var hasMetadata = false;
            var bodyClass = "ms-srch-item-body";
            var pathClass = "ms-srch-item-path";
            var resultWithMetadataPathClass = "";
            var maxUrlLength = Srch.U.pathTruncationLength;
            var maxTitleLengthInChars = Srch.U.titleTruncationLength;
            var termsToUse = 2;
            if (!$isNull(ctx.CurrentItem.CommunityMembersCount) ||
                !$isNull(ctx.CurrentItem.CommunityRepliesCount) ||
                !$isNull(ctx.CurrentItem.CommunityTopicsCount))
            {
                hasMetadata = true;
                bodyClass += " ms-srch-communityItem-body";
                pathClass += " ms-srch-communityItem-path";
                resultWithMetadataPathClass = "ms-srch-communityItem-path";
                maxUrlLength = Srch.U.pathTruncationLengthWithMetadata;
                maxTitleLengthInChars = Srch.U.titleTruncationLengthWithMetadata;
                termsToUse = 1;
            }

            var truncatedUrl = Srch.U.truncateHighlightedUrl(displayPath, Srch.U.pathTruncationLengthWithPreview);
_#-->
            <div id="_#= $htmlEncode(itemId) =#_" name="Item" data-displaytemplate="CommunityItem" class="ms-srch-item" onmouseover="_#= showHoverPanelCallback =#_" onmouseout="_#= hideHoverPanelCallback =#_">

                <div id="_#= $htmlEncode(id + Srch.U.Ids.body) =#_" class="_#= $htmlEncode(bodyClass) =#_" onclick="_#= showHoverPanelCallback =#_">
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.title) =#_" class="ms-srch-item-title">
                        <h3 class="ms-srch-ellipsis">
                            <a clicktype="Result" id="_#= $htmlEncode(id + Srch.U.Ids.titleLink) =#_" href="_#= $urlHtmlEncode(ctx.CurrentItem.Path) =#_" class="ms-srch-item-link" title="_#= $htmlEncode(ctx.CurrentItem.Title) =#_" onfocus="_#= showHoverPanelCallback =#_">
                                _#= Srch.U.trimTitle(title, maxTitleLengthInChars, termsToUse) =#_
                            </a>
                        </h3>
                    </div>
<!--#_
                var encodedHighlightedDescription = Srch.U.getHighlightedProperty(id, ctx.CurrentItem, "SiteDescription");
                if(!$isEmptyString(encodedHighlightedDescription))
                {
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.summary) =#_" class="ms-srch-communityItem-summary">
                        _#= encodedHighlightedDescription =#_
                    </div>
<!--#_
                }
                else if (!$isEmptyString(ctx.CurrentItem.HitHighlightedSummary))
                {
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.summary) =#_" class="ms-srch-communityItem-summary">
                        _#= Srch.U.processHHXML(ctx.CurrentItem.HitHighlightedSummary) =#_
                    </div>
<!--#_
                }
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.path) =#_" tabindex="0" class=" _#= $htmlEncode(pathClass) =#_ " title="_#= $htmlEncode(ctx.CurrentItem.Path) =#_" onblur="Srch.U.restorePath(this, '_#= $scriptEncode(truncatedUrl) =#_', '_#= $scriptEncode(ctx.CurrentItem.Path) =#_')" onclick="Srch.U.selectPath('_#= $scriptEncode(ctx.CurrentItem.Path) =#_', this); Srch.U.ensureCSSClassNameExist(this, '_#= $scriptEncode(resultWithMetadataPathClass) =#_');" onkeydown="Srch.U.setPath(event, this, '_#= $scriptEncode(ctx.CurrentItem.Path) =#_', '_#= $scriptEncode(truncatedUrl) =#_')" >
                        _#= truncatedUrl =#_
                    </div>
                </div>
<!--#_
            if(hasMetadata)
            {
_#-->
                <div class="ms-srch-item-metadataContainer">
                    <div class="ms-srch-item-metadataSeparator"></div>
<!--#_
                if (!$isNull(ctx.CurrentItem.CommunityMembersCount))
                {
                    var members = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(ctx.CurrentItem.CommunityMembersCount) + "</span>";
                    if(ctx.CurrentItem.CommunityMembersCount > maxMetadataValue)
                    {
                        members = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(String.format(Srch.Res.item_MoreThan, maxMetadataValue)) + "</span>";
                    }

                    if(ctx.CurrentItem.CommunityMembersCount == 1)
                    {
                        members = String.format($htmlEncode(Srch.Res.item_Community_Member), members);
                    }
                    else
                    {
                        members = String.format($htmlEncode(Srch.Res.item_Community_Members), members);
                    }
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.members) =#_" class="ms-metadata ms-srch-item-metadataText ms-srch-ellipsis">
                        _#= members =#_
                    </div>
<!--#_
                }
                if (!$isNull(ctx.CurrentItem.CommunityTopicsCount))
                {
                    var topics = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(ctx.CurrentItem.CommunityTopicsCount) + "</span>";
                    if(ctx.CurrentItem.CommunityTopicsCount > maxMetadataValue)
                    {
                        topics = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(String.format(Srch.Res.item_MoreThan, maxMetadataValue)) + "</span>";
                    }

                    if(ctx.CurrentItem.CommunityTopicsCount == 1)
                    {
                        topics = String.format($htmlEncode(Srch.Res.item_Community_Discussion), topics);
                    }
                    else
                    {
                        topics = String.format($htmlEncode(Srch.Res.item_Community_Discussions), topics);
                    }
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.discussions) =#_" class="ms-metadata ms-srch-item-metadataText ms-srch-ellipsis">
                        _#= topics =#_
                    </div>
<!--#_
                }
                if (!$isNull(ctx.CurrentItem.CommunityRepliesCount))
                {
                    var replies = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(ctx.CurrentItem.CommunityRepliesCount) + "</span>";
                    if(ctx.CurrentItem.CommunityRepliesCount > maxMetadataValue)
                    {
                        replies = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(String.format(Srch.Res.item_MoreThan, maxMetadataValue)) + "</span>";
                    }

                    if(ctx.CurrentItem.CommunityRepliesCount == 1)
                    {
                        replies = String.format($htmlEncode(Srch.Res.item_Reply), replies);
                    }
                    else
                    {
                        replies = String.format($htmlEncode(Srch.Res.item_Replies), replies);
                    }
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.replies) =#_" class="ms-metadata ms-srch-item-metadataText ms-srch-metadataText-extraVerticalPadded ms-srch-ellipsis">
                        _#= replies =#_
                    </div>
<!--#_
                }
_#-->
                </div>
<!--#_
            }
_#-->
                <div id="_#= $htmlEncode(hoverId) =#_" class="ms-srch-hover-outerContainer"></div>
            </div>
<!--#_
        }
_#-->
    </div>
</body>
</html>
