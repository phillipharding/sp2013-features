<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"> 
<head>
<title>$Resources:Microsoft.Office.Server.Search,DisplayTemplateTitle_ReplyItem</title>

<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:TemplateHidden msdt:dt="string">0</mso:TemplateHidden>
<mso:MasterPageDescription msdt:dt="string"></mso:MasterPageDescription>
<mso:ContentTypeId msdt:dt="string">0x0101002039C03B61C64EC4A04F5361F385106603</mso:ContentTypeId>
<mso:TargetControlType msdt:dt="string">;#SearchResults;#</mso:TargetControlType>
<mso:HtmlDesignAssociated msdt:dt="string">1</mso:HtmlDesignAssociated>
<mso:ManagedPropertyMapping msdt:dt="string">'Title':'Title','AuthorOWSUSER':'AuthorOWSUSER','Path':'Path','SiteLogo':'SiteLogo','SiteDescription':'SiteDescription','CollapsingStatus':'CollapsingStatus','DocId':'DocId','HitHighlightedProperties':'HitHighlightedProperties','FileExtension':'FileExtension','ViewsLifeTime':'ViewsLifeTime','deeplinks':'deeplinks','FileType':'FileType','ReplyCount':'ReplyCount','LikesCount':'LikesCount','BestAnswerId':'BestAnswerId','DiscussionCategory':'DiscussionCategory','DiscussionPost':'DiscussionPost','Created':'Created'</mso:ManagedPropertyMapping>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>
<body>
    <div id="Item_Reply">
<!--#_ 
        if(!$isNull(ctx.CurrentItem) && !$isNull(ctx.ClientControl))
        {
            var maxBodyLengthInChars = 120;
            var maxMetadataValue = Srch.U.maximumSocialMetadataValue;

            var id = ctx.ClientControl.get_nextUniqueId();
            var itemId = id + Srch.U.Ids.item;
            var hoverId = id + Srch.U.Ids.hover;
            var hoverUrl = "~sitecollection/_catalogs/masterpage/Display Templates/Search/Item_Reply_HoverPanel.js";
            $setResultItem(itemId, ctx.CurrentItem);

            var hasMetadata = false;
            var bodyClass = "ms-srch-item-body";
            var pathClass = "ms-srch-item-path";
            var resultWithMetadataPathClass = "";
            var maxUrlLength = Srch.U.pathTruncationLength;
            var maxTitleLengthInChars = Srch.U.titleTruncationLength;
            if (!$isNull(ctx.CurrentItem.ReplyCount) ||
                !$isNull(ctx.CurrentItem.LikesCount) ||
                !$isNull(ctx.CurrentItem.DiscussionLikesCount) ||
                !$isNull(ctx.CurrentItem.DiscussionBestAnswerID))
            {
                hasMetadata = true;
                bodyClass += " ms-srch-communityItem-body";
                pathClass += " ms-srch-communityItem-path";
                resultWithMetadataPathClass = "ms-srch-communityItem-path";
                maxUrlLength = Srch.U.pathTruncationLengthWithMetadata;
                maxTitleLengthInChars = Srch.U.titleTruncationLengthWithMetadata;
            }

            var title = "";
            if(!$isEmptyString(ctx.CurrentItem.DiscussionPost))
            {
                title = ctx.CurrentItem.DiscussionPost;
            }

            if ($isEmptyString(title))
            {
                title = ctx.CurrentItem.Title;
            }

            var displayPath = Srch.U.getHighlightedProperty(id, ctx.CurrentItem, "Path");
            var truncatedUrl = Srch.U.truncateHighlightedUrl(displayPath, maxUrlLength);

            var showHoverPanelCallback = Srch.U.getShowHoverPanelCallbackWide(itemId, hoverId, hoverUrl);
            var hideHoverPanelCallback = Srch.U.getHideHoverPanelCallback();
_#-->
            <div id="_#= $htmlEncode(itemId) =#_" name="Item" data-displaytemplate="ReplyItem" class="ms-srch-item" onmouseover="_#= showHoverPanelCallback =#_" onmouseout="_#= hideHoverPanelCallback =#_">

                <div id="_#= $htmlEncode(id + Srch.U.Ids.body) =#_" class=" _#= $htmlEncode(bodyClass) =#_ " onclick="_#= showHoverPanelCallback =#_">
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.title) =#_" class="ms-srch-item-title">
                        <h3 class="ms-srch-ellipsis">
                            <span class="ms-srchnav-quotationopenglyph-span">
                                <img class="ms-srchnav-quotationopenglyph" src="_#= $urlHtmlEncode(GetThemedImageUrl('searchresultui.png')) =#_" />
                            </span>
                            <a clicktype="Result" id="_#= $htmlEncode(id + Srch.U.Ids.titleLink) =#_" href="_#= $urlHtmlEncode(ctx.CurrentItem.Path) =#_" class="ms-srch-item-link" title="_#= $htmlEncode(title) =#_" onfocus="_#= showHoverPanelCallback =#_">
                                _#= $htmlEncode(Srch.U.truncateEnd(title, maxTitleLengthInChars)) =#_
                            </a>
                            <span class="ms-srchnav-quotationcloseglyph-span">
                                <img class="ms-srchnav-quotationcloseglyph" src="_#= $urlHtmlEncode(GetThemedImageUrl('searchresultui.png')) =#_" />
                            </span>
                        </h3>
                    </div>

                    <div id="_#= $htmlEncode(id + Srch.U.Ids.postInfo) =#_" class="ms-metadata">
<!--#_
                        var postInfoElementId = id + "_postInfoElement";
                        var nullableCreatedDate = ctx.CurrentItem.Created;
                        var author = "";
                        if (!$isEmptyString(ctx.CurrentItem.AuthorOWSUSER))
                        {
                            author = Srch.U.getDisplayNameFromAuthorField(ctx.CurrentItem.AuthorOWSUSER);
                        }

                        AddPostRenderCallback(ctx, function()
                        {
                            EnsureScriptFunc("sp.datetimeutil.js", "SP.DateTimeUtil.SPRelativeDateTime", function()
                            {
                                var dateString = "";
                                if(!$isNull(nullableCreatedDate))
                                {
                                    dateString = Srch.U.getFriendlyTimeInterval(nullableCreatedDate, Srch.U.getCalendarType());
                                }

                                var encodedPostInfo = "";
                                if(!$isEmptyString(author))
                                {
                                    var encodedAuthor = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(author) + "</span>";
                                    if(!$isEmptyString(dateString))
                                    {
                                        encodedPostInfo = String.format($htmlEncode(Srch.Res.item_replyAuthorDate),
                                            encodedAuthor,
                                            $htmlEncode(dateString));
                                    }
                                    else
                                    {
                                        encodedPostInfo = String.format($htmlEncode(Srch.Res.item_replyAuthor),
                                            encodedAuthor);
                                    }
                                }
                                else if(!$isEmptyString(dateString))
                                {
                                    encodedPostInfo = String.format($htmlEncode(Srch.Res.item_replyDate),
                                        $htmlEncode(dateString));
                                }

                                var targetElement = document.getElementById(postInfoElementId);
                                targetElement.innerHTML = encodedPostInfo;
                            });
                        });
_#-->
                        <span id="_#= $htmlEncode(postInfoElementId) =#_"></span>
                    </div>
<!--#_
                if(!$isEmptyString(ctx.CurrentItem.DiscussionPost))
                {
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.summary) =#_" class="ms-srch-communityItem-summary">
                        _#= $htmlEncode(Srch.U.truncateEnd(ctx.CurrentItem.DiscussionPost, maxBodyLengthInChars)) =#_
                    </div>
<!--#_
                }
                else if (!$isEmptyString(ctx.CurrentItem.HitHighlightedSummary))
                {
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.summary) =#_" class="ms-srch-communityItem-summary">
                        _#= Srch.U.processHHXML(ctx.CurrentItem.HitHighlightedSummary) =#_
                    </div>
<!--#_
                }
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.path) =#_" tabindex="0" class=" _#= $htmlEncode(pathClass) =#_ " title="_#= $htmlEncode(ctx.CurrentItem.Path) =#_" onblur="Srch.U.restorePath(this, '_#= $scriptEncode(truncatedUrl) =#_', '_#= $scriptEncode(ctx.CurrentItem.Path) =#_')" onclick="Srch.U.selectPath('_#= $scriptEncode(ctx.CurrentItem.Path) =#_', this); Srch.U.ensureCSSClassNameExist(this, '_#= $scriptEncode(resultWithMetadataPathClass) =#_');" onkeydown="Srch.U.setPath(event, this, '_#= $scriptEncode(ctx.CurrentItem.Path) =#_', '_#= $scriptEncode(truncatedUrl) =#_')" >
                        _#= truncatedUrl =#_
                    </div>
                </div>
<!--#_
            if(hasMetadata)
            {
_#-->
                <div class="ms-srch-item-metadataContainer">
                    <div class="ms-srch-item-metadataSeparator"></div>
<!--#_
                    var replyCount = 0;
                    if (!$isNull(ctx.CurrentItem.ReplyCount))
                    {
                        replyCount = ctx.CurrentItem.ReplyCount;
                    }

                    var replies = replyCount.toString();
                    if(replyCount > maxMetadataValue)
                    {
                        replies = String.format(Srch.Res.item_MoreThan, maxMetadataValue);
                    }

                    var encodedReplies = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(replies) + "</span>";
                    if(replyCount == 1)
                    {
                        encodedReplies = String.format($htmlEncode(Srch.Res.item_Reply), encodedReplies);
                    }
                    else if(replyCount > 1)
                    {
                        encodedReplies = String.format($htmlEncode(Srch.Res.item_Replies), encodedReplies);
                    }
                    else
                    {
                        encodedReplies = String.format($htmlEncode(Srch.Res.item_NoReplies), encodedReplies);
                    }
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.replies) =#_" class="ms-metadata ms-srch-item-metadataText">
                        _#= encodedReplies =#_
                    </div>
<!--#_
                    var likesCount = 0;
                    if (!$isNull(ctx.CurrentItem.DiscussionLikesCount))
                    {
                        likesCount = ctx.CurrentItem.DiscussionLikesCount;
                    }
                    else if (!$isNull(ctx.CurrentItem.LikesCount))
                    {
                        likesCount = ctx.CurrentItem.LikesCount;
                    }

                    var likes = likesCount.toString();
                    if(likesCount > maxMetadataValue)
                    {
                        likes = String.format(Srch.Res.item_MoreThan, maxMetadataValue);
                    }

                    var encodedLikes = "<span class='ms-srch-metadataText-emphasis'>" + $htmlEncode(likes) + "</span>";
                    if(likesCount == 1)
                    {
                        encodedLikes = String.format($htmlEncode(Srch.Res.item_Like), encodedLikes);
                    }
                    else if(likesCount > 1)
                    {
                        encodedLikes = String.format($htmlEncode(Srch.Res.item_Likes), encodedLikes);
                    }
                    else
                    {
                        encodedLikes = String.format($htmlEncode(Srch.Res.item_NoLikes), encodedLikes);
                    }
_#-->
                    <div id="_#= $htmlEncode(id + Srch.U.Ids.likes) =#_" class="ms-metadata ms-srch-item-metadataText">
                        _#= encodedLikes =#_
                    </div>
<!--#_
                if (!$isNull(ctx.CurrentItem.DiscussionBestAnswerID))
                {
_#-->
                    <div class="ms-srch-item-metadataText">
                        <span class="ms-srch-item-bestResponseIcon-span">
                            <img class="ms-comm-bestResponseIcon" src="_#= $urlHtmlEncode(GetThemedImageUrl('spcommon.png')) =#_" />
                        </span>
                        <span class="ms-metadata">
                            _#= $htmlEncode(Srch.Res.item_BestReply) =#_
                        </span>
                    </div>
<!--#_
                }
_#-->
                </div>
<!--#_
            }

            if(!Srch.U.e(ctx.CurrentItem.deeplinks) && !$isNull(ctx.CurrentItem.importance))
            {
_#-->
                <div class="ms-srch-item-deepLinks" id="_#= $htmlEncode(id + Srch.U.Ids.deepLinks) =#_">
                    _#= Srch.U.getDeepLinks(ctx.CurrentItem.deeplinks, ctx.CurrentItem.importance) =#_
                </div>
<!--#_
            }
_#-->
                <div id="_#= $htmlEncode(hoverId) =#_" class="ms-srch-hover-outerContainer"></div>
            </div>
<!--#_
        }
_#-->
    </div>
</body>
</html>
