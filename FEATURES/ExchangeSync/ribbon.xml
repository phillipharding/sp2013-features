<!-- Custom ribbon action to override the SP Task List Connect to Outlook button with Connect to Exchange -->
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
	<!-- There are 3 task list types we need to override for -->
	<CustomAction Id="Ribbon.List.Actions.ExchangeSync" Location="CommandUI.Ribbon.ListView" RegistrationType="List" RegistrationId="107" Sequence="30" Title="$Resources:wmafeatures,AWIOP_SyncToOutlook;" > <CommandUIExtension> <CommandUIDefinitions> <CommandUIDefinition Location="Ribbon.List.Actions.ConnectToClient" > <Button Id="Ribbon.WMA.ExchangeSyncSettings" Sequence="30" Command="ExchangeSyncSettings" Image16by16="/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23" Image16by16Top="-55" Image16by16Left="-241" Image32by32="/_layouts/15/$Resources:core,Language;/images/formatmap32x32.png?rev=23" Image32by32Top="-307" Image32by32Left="-137" LabelText="$Resources:wmafeatures,AWIOP_SyncToOutlook;" ToolTipTitle="$Resources:wmafeatures,AWIOP_SyncToOutlook_SuperTooltipHeader;" ToolTipDescription="$Resources:wmafeatures,AWIOP_SyncToOutlook_SuperTooltipDesc;" TemplateAlias="o1" /> </CommandUIDefinition> </CommandUIDefinitions> <CommandUIHandlers> <CommandUIHandler Command="ExchangeSyncSettings" CommandAction="javascript:     function OpenExchangeSyncSettingsDlg()     {         SP.SOD.executeFunc('sp.js', 'SP.Utilities.Utility.getLayoutsPageUrl', function()          {             var url = SP.Utilities.Utility.getLayoutsPageUrl('ExchangeSyncSettings.aspx');             SP.SOD.executeFunc('sp.ui.dialog.js', 'SP.UI.ModalDialog.showModalDialog', function()              {                 var options = { url: url };                 SP.UI.ModalDialog.showModalDialog(options);              });         });     }     OpenExchangeSyncSettingsDlg();" /> </CommandUIHandlers> </CommandUIExtension> </CustomAction>
	<CustomAction Id="Ribbon.List.Actions.ExchangeSync" Location="CommandUI.Ribbon.ListView" RegistrationType="List" RegistrationId="150" Sequence="30" Title="$Resources:wmafeatures,AWIOP_SyncToOutlook;" > <CommandUIExtension> <CommandUIDefinitions> <CommandUIDefinition Location="Ribbon.List.Actions.ConnectToClient" > <Button Id="Ribbon.WMA.ExchangeSyncSettings" Sequence="30" Command="ExchangeSyncSettings" Image16by16="/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23" Image16by16Top="-55" Image16by16Left="-241" Image32by32="/_layouts/15/$Resources:core,Language;/images/formatmap32x32.png?rev=23" Image32by32Top="-307" Image32by32Left="-137" LabelText="$Resources:wmafeatures,AWIOP_SyncToOutlook;" ToolTipTitle="$Resources:wmafeatures,AWIOP_SyncToOutlook_SuperTooltipHeader;" ToolTipDescription="$Resources:wmafeatures,AWIOP_SyncToOutlook_SuperTooltipDesc;" TemplateAlias="o1" /> </CommandUIDefinition> </CommandUIDefinitions> <CommandUIHandlers> <CommandUIHandler Command="ExchangeSyncSettings" CommandAction="javascript:     function OpenExchangeSyncSettingsDlg()     {         SP.SOD.executeFunc('sp.js', 'SP.Utilities.Utility.getLayoutsPageUrl', function()          {             var url = SP.Utilities.Utility.getLayoutsPageUrl('ExchangeSyncSettings.aspx');             SP.SOD.executeFunc('sp.ui.dialog.js', 'SP.UI.ModalDialog.showModalDialog', function()              {                 var options = { url: url };                 SP.UI.ModalDialog.showModalDialog(options);              });         });     }     OpenExchangeSyncSettingsDlg();" /> </CommandUIHandlers> </CommandUIExtension> </CustomAction>
	<CustomAction Id="Ribbon.List.Actions.ExchangeSync" Location="CommandUI.Ribbon.ListView" RegistrationType="List" RegistrationId="171" Sequence="30" Title="$Resources:wmafeatures,AWIOP_SyncToOutlook;" > <CommandUIExtension> <CommandUIDefinitions> <CommandUIDefinition Location="Ribbon.List.Actions.ConnectToClient" > <Button Id="Ribbon.WMA.ExchangeSyncSettings" Sequence="30" Command="ExchangeSyncSettings" Image16by16="/_layouts/15/$Resources:core,Language;/images/formatmap16x16.png?rev=23" Image16by16Top="-55" Image16by16Left="-241" Image32by32="/_layouts/15/$Resources:core,Language;/images/formatmap32x32.png?rev=23" Image32by32Top="-307" Image32by32Left="-137" LabelText="$Resources:wmafeatures,AWIOP_SyncToOutlook;" ToolTipTitle="$Resources:wmafeatures,AWIOP_SyncToOutlook_SuperTooltipHeader;" ToolTipDescription="$Resources:wmafeatures,AWIOP_SyncToOutlook_SuperTooltipDesc;" TemplateAlias="o1" /> </CommandUIDefinition> </CommandUIDefinitions> <CommandUIHandlers> <CommandUIHandler Command="ExchangeSyncSettings" CommandAction="javascript:     function OpenExchangeSyncSettingsDlg()     {         SP.SOD.executeFunc('sp.js', 'SP.Utilities.Utility.getLayoutsPageUrl', function()          {             var url = SP.Utilities.Utility.getLayoutsPageUrl('ExchangeSyncSettings.aspx');             SP.SOD.executeFunc('sp.ui.dialog.js', 'SP.UI.ModalDialog.showModalDialog', function()              {                 var options = { url: url };                 SP.UI.ModalDialog.showModalDialog(options);              });         });     }     OpenExchangeSyncSettingsDlg();" /> </CommandUIHandlers> </CommandUIExtension> </CustomAction>
</Elements>
